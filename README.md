# Real Time Firearm Detection from Closed Circuit Television videos

Problem Statement:
A firearm detection system can enable early warning of potentially violent situations, which is critical for public safety. One technique to avoid these scenarios is to identify the presence of dangerous things in surveillance cameras, such as pistols and handguns. The model will be fed CCTV footage as an input, and the output of the project will be CCTV footage with firearms identified per frame within a bounding box.

Dataset:
We have used the Guns Object Detection dataset on Kaggle. The repository contains labeled images of guns taken from various sources. It consists of several images with text files.The image has been reconstructed into square images and were retained in the RGB/BGR format. Weapon photos are gathered and prepared for the dataset creation in order to build the dataset. This dataset contains photographs in the Images folder that are in jpeg format and are obtained from the internet. Another folder called Labels has text files in the txt format, each of which begins with a list of objects from the accompanying image and ends with the coordinates of the object. Training is done with this.

Algorithm:
We will be making use of the YOLOv3 algorithm to detect firearms. We have the necessary dataset, which contains just one class. This dataset is further trained using the YOLOv3 (You Only Look Once) algorithm for the categorization of weaponry. The system will be able to identify the type of weapon present in the real-time input footage from the surveillance cameras (CCTVs) once the data has been effectively trained. A threat notice will be transmitted to the appropriate authorities if the weapon is found. The feature extraction and object localization processes in YOLOv3 are combined into a single, standardized block. Its YOLO (You Only Look Once) single-stage architecture produces a very quick surmise time. It predicts the bounding box coordinates and class probabilities for these boxes for an object using the complete image in a single case. Unlike previous techniques, which scan photos with a sliding window, YOLO passes the entire image through a convolutional neural network (CNN) and predicts the result in a single run. The Kaggle dataset is stored in the darknet folder and uploaded to drive.The uploaded dataset is further split into 70% training data and 30% testing data, and the photographs are organized into several folders that can be utilized to continue model training. The deep neural network module of OpenCV has a built-in implementation of Darknet, the deep learning framework from which YOLO is taught. With code we are loading the network and passing the YOLOv3 configuration and weights. An input image is read,to obtain the output a forward pass is conducted after setting the neural network's input. A prediction is created after processing the neural network's output. Low confidence detection is removed, and overlapping bounding boxes are deleted using non-max suppression in order to avoid multiple bounding boxes around the object and to get the optimum bounding box. If this weapon is detected in the image and alert is created.

Execution:
The following are the steps for runnning the testing part(detection) part of the code. The training part of the code is in Training_YoloV3_firearm_detection.ipynb jupyter notebook. To generate the configuration and weights please run the notebook in google colab.

Requirements:
Python 3.8 or above with all requirements dependencies installed. To install run:

"$ pip3 install -r requirements.txt"

Do not change any configuration files or weights files as they are generated by training YOLO v3 on gun dataset taken from Kaggle : https://www.kaggle.com/datasets/issaisasank/guns-object-detection

The file main.py contains the code for detection firearm in three scenarios:
1. Image
2. Video
3. Realtime

Execute the run.sh file for execution of code. The main.py will pick default inputs set in root directory for performing gun detection.

References:
1. https://www.section.io/engineering-education/introduction-to-yolo-algorithm-for-object-detection/
2. https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/
3. https://pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv

